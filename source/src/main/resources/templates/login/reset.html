<!DOCTYPE html>
<html lang="ZH-CN"  >
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <link href="./css/public.css" type="text/css" rel="stylesheet" />
     <link href="./css/reset.css" type="text/css" rel="stylesheet" />
     <link href="./css/main.css" type="text/css" rel="stylesheet" />
     <script type="text/javascript" src="../js/jquery-1.11.1.min.js"></script>
    <script src="../js/jquery.pwdstrategy.js"></script>
    <script src="../js/base64.min.js"></script>
     <title>后台管理登录界面</title>
     <style>
          .login_c {
               top: 85px;
          }
          .qydm{min-height: 50px;}
          .login_input_panel{padding-top: 25px;}
          .pwdstr{ display: block; padding: 10px 0 0 0 ;}
          *{
               box-sizing: border-box;
          }
          .logo-box{
              height: 90px;
              text-align: center; 
          }
          .logo-box img{
               height: 100%;
               vertical-align: middle;
          }
          .main{
               position: relative;
               height: calc(100vh - 90px);
               min-height: 600px;
               width:100%;
               min-width: 1000px;
               zoom: 1;
               background-color: #fff;
               background: url('./images/bgporsche.png') no-repeat;
               background-size: cover;
               background-position: center 0;
          }
          .login_c {
               top: 45% !important;
               transform: translateY(-50%);
          }
          .footer{
               position: absolute;
               bottom: 0;
               background: none;
               border: none;
          }
          .footer_1200 a,.footer_1200 p{
               color: #fff;
          }
          .school{
               top: 35px;
               left: 30px;
               width: auto;
               text-align: left;
               margin: 0;
               border: none;
               padding: 0;
          }
          .school a{
               line-height: 50px;
          }
          .modal-footer .btn-primary{ background-color: #d5001c;border-color: #d5001c;width:100%;}
          .footer_1200 a{text-decoration:underline;}
          .login_right{
               width: 490px;
               padding: 32px 40px;
          }
          .login_right .login_PT{
               text-align: left;
               color: #000;
               background: none;
               text-indent: 0;
               font-size: 26px;
               line-height: 48px;
          }
          .login_input_panel{
               padding-top: 15px;
          }
          .qydm{
               height: auto;
               width: 100%;
               margin: 0;
               margin-bottom: 8px;
          }
          .p-input >p{
               font-size: 16px;
               line-height: 32px;
               color: #000;
          }
          .p-input input{
               padding: 12px 0;
               margin: 0;
               height: 60px;
               width: 100%;
               border: 1px solid #626669;
               box-sizing: border-box;
          }
          .login_tip{
               padding: 0;
               margin: 0 0 8px 340px;
          }
          .login_btn{
               margin: 0;
               width: 100%;
          }
          .login_btn:hover{
               background: #980014;
          }
          .login_btn .login_btn_submit{
               text-align: left;
               text-indent: 12px;
          }
          .login_btn .login_btn_submit img{
               height: 24px;
               vertical-align: text-top;
          }
     </style>
</head>

<body>
     <form id="form1" >
          <header class="logo-box">
               <img src="./images/logoporsche.png" alt="">
          </header>
          <div class="main">
               <div class="login_c">
                    <div class="w1200 clearfix">
     
                         <div class="login_right">
                              <div class="login_PT">重置密码</div>
                              <div class="login_input_panel" th:if="${isvalid}==1">
     <!--                              <div class="qydm">-->
     <!--                                   <div class="sr2">-->
     
     <!--                                        <input type="text" ID="userid" name="userid" Width="305px" Height="32px"-->
     <!--                                             placeholder="企业代码"/>-->
     <!--                                   </div>-->
     <!--                              </div>-->
                                   <div class="qydm">
                                        <div class="p-input">
                                             <p>邮箱</p><input type="hidden" name="id" th:value="${id}" />
                                             <input ID="username" name="username" Width="305px" Height="32px" th:value="${map.username}"
                                                  placeholder="邮箱"  readonly="readonly" />
     
                                        </div>
                                   </div>
     
                                  <div class="qydm">
                                        <div class="p-input">
                                             <p>新密码</p>
                                             <input ID="password" name="password"  Width="305px" Height="32px" type="password"
                                                  TextMode="Password" placeholder="新密码"/>
                                        </div>
                                  </div>
                                  <div class="qydm">
                                        <div class="p-input">
                                             <p>确认密码</p>
                                             <input ID="password2" name="password2"  Width="305px" Height="32px" type="password"
                                                  TextMode="Password" placeholder="确认密码"/>
                                        </div>
                                  </div>
                                  <a class="login_tip" href="login">返回登录</a>
                                   <div class="login_btn">
                                        <div ID="btnSumbit" class="login_btn_submit" Text=""
                                             >重置密码</div>
                                   </div>
                              </div>
                              <div class="login_input_panel" th:if="${isvalid}==0" style="text-align:center;">
                                  该请求无效或已过期</br>
                                  <a class="login_tip" href="login">返回登录</a>
                              </div>
                         </div>
     
                    </div>
               </div>
               <!--底部-->
               <div class="footer">
                    <div class="school"><a href="http://allianz.chinaopenschool.com" target="_blank">E-learning</a></div>
                    <div class="footer_1200  clearfix">
     
                         <p>版权所有：Copyright© 2019 Allianz. All Rights Reserved.</p>
                    </div>
               </div>
          </div>
     </form>
<script>
     var reset=function(){
          if($("#password").val()==""){
               $("#password").focus();
               return;
          }
         if(!$("#password").pwdpass()){
             alert("密码必须包含数字、英文特及殊字符，不少于8个字符！");
             return ;
         }
         if($("#password2").val()!=$("#password").val()){
             $("#password2").focus();
             alert("两次密码不一样");
             return;
         }
         var pwd = $("#password").val();
         $("#password").val(Base64.encode(pwd));
         var pwd2 = $("#password2").val();
         $("#password2").val(Base64.encode(pwd2));
          $.post("../login/reset",$("#form1").serialize(),function (data) {
               if(data.code==1){
                   alert("修改成功，请重新登录");
                   location.href="login";
               }else{
                   //console.info(data.msg);
                    alert(data.msg);
               }
          },"json");
     };
     $(function () {
         $("#password").pwdstrategy();
          $(window).bind("keydown",function(event) {
               var event=event||window.event;
               if(event.keyCode==13) {
                   reset();
               }
          });
          $("#btnSumbit").click(function(){
               reset();
          });
     })
</script>
</body>

</html>