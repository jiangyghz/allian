<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../js/bootstrap-table/bootstrap-table.min.css" rel="stylesheet" />
    <link href="../css/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <title>产品列表</title>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <![endif]-->
    <script src="../js/jquery-1.11.1.min.js"></script>
    <script src="../js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../js/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="../js/bootstrap-table/bootstrap-table-zh-CN.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/jquery.cookie.js"></script>
    <script type="text/javascript" src="../js/thechart.js"></script>
    <style type="text/css">

        body {
            background: #eeeff2;
        }

        .cssPager {
            background: #FFFFFF none repeat scroll 0 0;
            border: 1px solid #CCCCCC;
            color: #1F3A87;
            margin: 5px 4px 0 0;
            padding: 4px 5px 0;
            text-decoration: none;
        }
        .anpager {
            font: 11px Arial, Helvetica, sans-serif;
            padding: 10px 20px 10px 0;
            margin: 0px;
        }

        .anpager a {
            padding: 1px 6px;
            border: solid 1px #ddd;
            background: #fff;
            text-decoration: none;
            margin-right: 2px
        }

        .anpager a:visited {
            padding: 1px 6px;
            border: solid 1px #ddd;
            background: #fff;
            text-decoration: none;
        }

        .anpager .cpb {
            padding: 1px 6px;
            font-weight: bold;
            font-size: 13px;
            border: none
        }

        .anpager a:hover {
            color: #fff;
            background: #ffa501;
            border-color: #ffa501;
            text-decoration: none;
        }
    </style>

    <script>
        $(function () {
            $(".table-responsive").removeClass("panel").end();
            $(".table-responsive").find("div:first").addClass("panel").css("border", "none");

        })
    </script>

</head>

<body>
        <div class="container-fluid">
            <!-- 内容部分 -->
            <!-- 按时间查询 -->
            <div class="panel">
                <div class="row o-row">
                   
<!--                    <div class="col-md-2">-->
<!--                            <lable class="control-label o-lable-sty">保险公司代码</lable>-->
<!--                        <input name="keyicode" type="text" id="keyicode" class="form-control" placeholder="保险公司代码"-->
<!--                               style="display:inline;">-->
<!--                    </div>-->
                    
                    <div class="col-md-2">
                            <lable class="control-label o-lable-sty">产品名称</lable>
                        <input name="keypname" type="text" id="keypname" class="form-control" placeholder="产品名称"
                               style="display:block;">
                    </div>

                    <div class="col-md-2">
                            <lable class="control-label o-lable-sty">是否有效</lable>
                            <select name="keyvalid" id="keyvalid"
                                class="form-control">
                                <option selected="selected" value="-1">全部</option>
                                <option value="1">是</option>
                                <option value="0">否</option>
                            </select>
                        </div>
                    <div class="col-md-1" style="width:80px;">
                            <lable class="control-label o-lable-sty">&nbsp;</lable>
                        <input type="button" name="Button3" value="查询" id="btnSearch" class="btn icon-search">
                    </div>

                    <div class="col-md-1" style="width:80px;">
                        <lable class="control-label o-lable-sty">&nbsp;</lable>
                        <button type="button" class="btn btn-warning ent-modal"  href="productedit" data-size="maxmodal" >添加产品</button>
                    </div>
                </div>

            </div>

            <!-- chart图标 -->

            <!-- 表格 -->
            <div class="table-responsive">

                <div class="panel" style="border: none;">
                    <table cellspacing="0" rules="all" class="table table-striped table-bordered" border="1"
                        id="table1" style="border-collapse:collapse;"
                           data-show-columns="false"
                           data-pagination="true"
                           data-sortable="true"
                           data-resizable="true">
                        <thead>
                            <tr>
                                <th scope="col" data-field="pname">产品名称</th>
                                <th scope="col" data-field="brand">品牌</th>
                                <th scope="col" data-field="groupname">分组</th>
<!--                                <th scope="col" data-field="icode">保险公司代码</th>-->
<!--                                <th scope="col" data-field="retailprice">零售价</th>-->
                                <th scope="col" data-field="agentprice"  >代理价</th>
                                <th scope="col" data-field="cost">成本</th>
                                <th scope="col" data-field="valid" data-formatter="fmtvalid">状态</th>
                                <th data-field="productid" data-formatter="fmthandler">操作</th>
                            </tr>
                        </thead>
                    </table>
                </div>



            </div>




        </div>
        <script>
            var postParam={};
            var Search=function(){
                postParam={};
                if ($("#keyicode").val() != "") postParam.keyicode = $("#keyicode").val();
                if ($("#keypname").val() != "") postParam.keypname = $("#keypname").val();
                postParam.keyvalid = $("#keyvalid").val();
                postParam.tokensign=$.cookie("tokensign");
                var gridOpts=$("#table1").bootstrapTable('getOptions');
                var parm = { "curPageIndex": gridOpts.pageNumber,
                    "pageSize": gridOpts.pageSize,
                    "action": "GetData"
                };
                $.ajaxQueryPage('#table1',$.extend(parm,postParam));
            };
            var fmtvalid=function(value,row){
                var v="";
                switch(parseInt(row.valid)){
                    case 0:
                        v="无效";
                        break;
                    case 1:
                        v="有效";
                        break;
                }
                return v;
            };
            var fmthandler=function(index,row){
                var html="";
                html+="<a class='ent-modal' href='javascript:void(0);' data-size='3' role='productedit?id="+row.productid+"'>编辑</a>";
                if(row.valid==1) {
                    html += " <a class='a' href='javascript:void(0);' key='" + row.productid + "' onclick='ent.del(this);'>设置无效</a>";
                }
                return html;
            };

            var ent={
                del:function(e){
                    if(confirm("确定无效？")){
                        var id=$(e).attr("key");
                        $.post(location.href,{ "action": "del", "id": id,"tokensign":$.cookie("tokensign") },function(d) {
                            if (d[0]) {
                                Search();
                            }else{
                                alert(d[1]);
                            }
                        });
                    }
                }
            };
            $(function(){
                $("#table1").bootstrapTable({
                    onPageChange:function(number, size){
                        Search();
                    }
                });
                Search();
                $("#btnSearch").click(function(){
                    Search();
                });
                $(window).bind("keydown",function(event) {
                    var event=event||window.event;
                    if(event.keyCode==13) {
                        Search();
                    }
                });
            });

        </script>

</body>

</html>