<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>用户修改</title>
    <link rel="stylesheet" href="../js/bootstrap-select/bootstrap-select.min.css">
    <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <script src="../js/bootstrap-select/bootstrap-select.min.js"></script>
    <script src="../js/bootstrap-validation/bootstrap3-validation.min.js"></script>
    <script src="../js/base64.min.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/jquery.cookie.js"></script>
</head>

<body>
<div class="modal-header" >
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    <h4 class="modal-title" id="exampleModalLabel" th:text="${user.id}!=null?'用户修改':'用户添加'"></h4>
</div>

<div class="modal-body" id="userbody" style=" overflow:auto;">
    <form id="form1" role="form"  class="form-horizontal" >
<!--        <div class="form-group" th:if="${isagency==1}">-->
<!--            <label class="col-sm-3 control-label">经销商代码：</label>-->
<!--            <div class="col-xs-8">-->
<!--                <input type="text" class="form-control "  th:value="${agencyid}" name="agencyid"  maxlength="20" th:attr="readonly=${agencyid}=='0'?'false':'readonly'"  />-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="form-group" th:if="${isagency==1}">-->
<!--            <label class="col-sm-3 control-label">经销商名称：</label>-->
<!--            <div class="col-xs-8">-->
<!--                <input type="text" class="form-control "  th:value="${agencyname}" name="agencyname"  maxlength="20" readonly=readonly />-->
<!--            </div>-->
<!--        </div>-->
        <div class="form-group" th:if="${user.id!=null}">
            <label class="col-sm-3 control-label">登录名：</label>
            <div class="col-xs-8"><input type="hidden" id="useragency" value="${user.agencyid}">
                <input type="text" class="form-control " check-type="required" th:value="${user.username}" name="username"  maxlength="50" th:attr="readonly=${user.id}!=null?'readonly':'false'" />
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">邮箱：</label>
            <div class="col-xs-8">
                <input type="text" class="form-control "  check-type="required"  th:value="${user.email}" name="email" maxlength="50" />
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">姓名：</label>
            <div class="col-xs-8">
                <input type="text" class="form-control " check-type="required" th:value="${user.truename}" name="truename" maxlength="20"   />
            </div>
        </div>
        <div class="form-group" th:if="${user.id}==null">
            <label class="col-sm-3 control-label">密码：</label>
            <div class="col-xs-8">
                <input type="password" class="form-control " check-type="required" th:value="${user.password}" name="password" id="password" maxlength="100" />
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">电话：</label>
            <div class="col-xs-8">
                <input type="text" class="form-control "  check-type="required" th:value="${user.tel}" name="tel" maxlength="20" />
            </div>
        </div>

        <div class="form-group" th:if="${user.id}!=null">
            <label class="col-sm-3 control-label">状态：</label>
            <div class="col-xs-8">
                <select id="valid" name="valid" style="width:140px;" class="form-control ">
                    <option value="1"  th:attr="selected=${user.valid}==1?'selected':'false'">有效</option>
                    <option value="0"  th:attr="selected=${user.valid}==0?'selected':'false'">无效</option>

                </select>
            </div>
        </div>
<!--        <div class="form-group">-->
<!--            <label class="col-sm-3 control-label">激活：</label>-->
<!--            <div class="col-xs-8">-->
<!--                <select id="isactived" name="isactived" style="width:140px;" class="form-control ">-->
<!--                    <option value="1"  th:attr="selected=${user.isactived}==1?'selected':'false'">是</option>-->
<!--                    <option value="0"  th:attr="selected=${user.isactived}==0?'selected':'false'">否</option>-->

<!--                </select>-->
<!--            </div>-->
<!--        </div>-->

    </form>
</div>
<div class="modal-footer" style="text-align:center;">
    <button type="button" class="btn btn-primary" id="btnSubmit">确认</button>
    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
</div>
<script th:inline="javascript">
    $(function(){
        //$("#agencyid1").selectpicker({});
        //$("#agencyid1").selectpicker('refresh');
        //$("#agencyid1").selectpicker('render');
        $('#form1').validation({reqmark:false});
        $("#act").change(function(){
            if($(this).val()=="经销商"){
                // if($("#useragency").val()=="zb"){
                //     $("#agencyid1").val("");
                // }
                $("#code").show();
            }else{
                $("#code").hide();
                $("#agencyid1").val("");
            }
            if($(this).val()=="保险公司"){
                // if($("#agencyid1").val()=="zb"){
                //     $("#agencyid1").val("");
                // }
                $("#div_icode").show();

            }else{
                $("#div_icode").hide();
                $("#icode").val("");
            }
        }).trigger("change");//.change();
        $("#btnSubmit").click(function(){
            if($("#form1").valid()==false){
                $(".form-group.has-error").eq(0).find("input,select,textarea").focus();
                return false;
            }
            if($("#password").length>0) {
                var pwd = $("#password").val();
                $("#password").val(Base64.encode(pwd));
            }
            $.post("agencyuseredit?id="+[[${id}]],$("form").serialize()+"&action=save&tokensign="+$.cookie("tokensign"),function(data){
                //console.info(data);
                if(data[0]){
                    closemodal();
                    try{
                        Search();
                    }catch(e){};
                }else{
                    alert(data[1]);
                }
            },"json");
        });
    });

</script>
</body>

</html>